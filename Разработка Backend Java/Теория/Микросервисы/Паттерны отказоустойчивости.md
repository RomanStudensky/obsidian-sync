# На уровне всей системы (архитектура/инфра)

- **Избыточность и устранение единичных точек отказа (SPOF):** N+1 для всего: инстансы, БД-реплики, брокеры, балансировщики, AZ/регионы.
    
- **Мульти-AZ/мульти-регион:** актив–актив/актив–пассив, гео-репликация, локальные фейловеры. Определите **RTO/RPO** заранее.
    
- **Балансировка и маршрутизация:** L4/L7 балансеры, health-checks, weight-based/least-loaded, **канареечные/blue-green** релизы, прогрессивная выкладка.
    
- **Очереди и асинхронность:** декуплинг через брокеры, **DLQ**, ретраи, приоритетные очереди, дедупликация.
    
- **Хранение данных:** шардирование, репликация, кворумы (R/W), **leader election** (Raft/ZK), **read-replicas**, anti-entropy/repair.
    
- **Консистентность/доступность:** CAP-компромиссы, **eventual consistency**, **идемпотентные** операции, **саги** вместо распределённых транзакций.
    
- **Backpressure & rate limiting:** глобальные лимиты, токен-бакеты, очереди ожидания, **shed-ding** (отбрасывание низкоприоритетного трафика).
    
- **Автовосстановление:** авто-рестарт, авто-замена узлов, self-healing оркестраторы (K8s), pod disruption budgets.
    
- **Наблюдаемость:** **SLO/SLI**, централизованные логи/метрики/трейсы, аномалия-детекция, алерты с ротацией.
    
- **Chaos/Fault-injection:** регулярные эксперименты: отключения AZ, потери пакетов, пиковые нагрузки.
    
- **Управление фичами:** feature flags, **graceful degradation**/**brownout** (отключаем «дорогие» фичи под нагрузкой).
    
- **Безопасные деплойменты:** blue-green, canary, rollbacks, иммутабельные артефакты, зафиксированные манифесты.
    
- **Операционные практики:** runbooks, игровая книга инцидентов, пост-мортемы без поиска виноватых.
    

# На уровне приложения/кода (паттерны и практики)

- **Timeouts везде:** явные таймауты на I/O и RPC; избегайте бесконечных ожиданий.
    
- **Retry с джиттером:** экспоненциальная пауза + **full jitter**; учитывайте идемпотентность.
    
- **Circuit Breaker:** открытие при ошибках, **half-open** для проб; защищает зависимости.
    
- **Bulkhead (перегородки):** изоляция пулов потоков/соединений по доменам, чтобы сбой не утопил всё.
    
- **Fallback/кэш/стаб:** деградация функционала (кэшированные/упрощённые ответы) при сбое зависимости.
    
- **Hedging/duplex hedged requests:** дублируем долгие запросы в другой инстанс после небольшого таймаута.
    
- **Идемпотентность и дедупликация:** idempotency-key, версионирование, upsert, «не списывать дважды».
    
- **Саги (оркестр/хореография):** согласованность без 2PC, компенсирующие действия.
    
- **Transactional Outbox + Poller/CDC:** гарантированная доставка событий из БД в шину.
    
- **CQRS + Event Sourcing (когда оправдано):** разделение чтения/записи, восстановление из событий.
    
- **Лизы и heartbeats:** временные права владения ресурсом, чтобы избегать split-brain.
    
- **Защита от «токсичных» сообщений:** валидация, квоты, DLQ, poison-pill handling.
    
- **Грейсфул-shutdown:** ловим SIGTERM, завершаем в работе запросы, снимаем из балансера.
    
- **Конфиги и флаги:** динамические лимиты/таймауты без рестартов.
    
- **Тестирование надёжности:** юнит-фолт-тесты, хаос-тесты, нагрузочные, property-based.
    

# Быстрый чек-лист перед продом

1. Таймауты + ретраи с джиттером стоят на всех клиентах.
    
2. Circuit breaker & bulkheads для внешних зависимостей.
    
3. Идемпотентность критичных операций + outbox/CDC для событий.
    
4. Health-checks, readiness/liveness, graceful shutdown.
    
5. Наблюдаемость: метрики латентности/ошибок/сатурации, трассировки.
    
6. План DR: RTO/RPO, фейловер проверен упражнениями.
    
7. Canary/blue-green и быстрый rollback.
    
8. Документы: SLO/SLA, runbooks, кто on-call.
    

# Когда что выбирать (очень кратко)

- Высокая нагрузка/спайки → очереди, лимитирование, brownout.
    
- Много сервисов → саги, outbox, идемпотентность, circuit breaker.
    
- Жёсткие SLO по доступности → multi-AZ/регион, кворумы, репликация, hedging.
    
- Критичны транзакции → саги + компенсирующие, максимально локальные транзакции.
    

Если хотите, соберу для вашего стека (Spring Boot 3.5.x, Kafka/Rabbit, Postgres/Redis, K8s) минимальный «боевой» набор с примерами кода (Resilience4j, Spring Retry, Outbox на JPA, health-эндпойнты, readiness-пробы).