
Сообщение, отправленное брокеру и записанное на диск, может дублироваться в реплики. В случае отправки сообщения брокеру и выхода из строя мастер-брокера до отправки ответа, производитель повторит попытку и продублирует запись в реплике. Реплика может направить потребителю сообщение, которое уже прочитано им. Чтобы избежать этого, можно использовать параметр **enable.idempotence=true**. Производитель будет прикреплять порядковый номер к каждому сообщению, потребитель следить за чтением сообщений с одинаковыми номерами и выбрасывать исключение в таком случае.